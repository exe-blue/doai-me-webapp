{
  "created_at": "2026-02-06T17:20:17.339Z",
  "trigger": "auto",
  "active_modes": {
    "ultrawork": {
      "original_prompt": "ulw Claude Code Prompt (Max-Specified: Columns + Copy + States + Toasts)\n\nYou are Claude Code acting as a senior frontend engineer. Implement the “시청관리(구 작업관리)” overhaul end-to-end in a React/Next.js + TypeScript codebase. Assume you do NOT have full product specs; use the Defaults below and still deliver working UI. Keep all user-facing copy in Korean. Return: plan, checklist, changed files, and key code.\n\nDefaults (apply unless repo dictates otherwise)\n\nPages:\n\n“시청관리” list page exists (or create): route /watch\n\n“영상 등록” page exists: route /videos/new\n\nData entities:\n\nCampaign (영상) has id, title, channelHandle, videoId, registrationMethod, createdAt\n\nWatchSession (시청) is a row in 시청관리: id, watchId, status, priorityEnabled, paused, createdAt, startedAt?\n\nBackend endpoints may not exist; if missing, implement FE with mock adapters and document contracts.\n\nPR Title\n\n시청관리 테이블 중심 개편(용어/색상/고유번호/현황조회/중복방지/링크정규화/액션정상화)\n\nHard Requirements\n\n사용자 노출 “작업” → “시청” 전면 교체\n\n“새 시청” 버튼을 테마 Primary로 통일\n\n시청 고유번호 YYYYMMDD_handle_### 생성/저장/표시\n\n로그 제거 → “시청 현황” 조회 모달로 대체(노드/시청중 디바이스 수)\n\n우선순위/일시정지/삭제 실제로 동작\n\n동일 영상 재등록 방지(videoId 기준)\n\n유튜브 URL은 canonical https://www.youtube.com/watch?v=<id>로 강제(쿼리/short/outu.be 제거)\n\n시청관리 테이블에서 대부분 정보 파악 가능하도록 컬럼/표시 강화\n\n1) UX Copy Spec (Korean UI strings to implement)\n1.1 Page / Nav\n\nMenu item: 시청관리\n\nPage title: 시청관리\n\nPrimary CTA button: 새 시청\n\nSecondary CTA: 영상 등록 (optional; links to /videos/new)\n\n1.2 Empty / Loading / Error\n\nList loading: 시청 목록을 불러오는 중...\n\nList empty title: 아직 시청이 없습니다\n\nList empty body: 새 시청을 생성하거나 영상을 등록하면 여기에서 진행 상태를 확인할 수 있어요.\n\nList empty CTA: 새 시청 만들기\n\nList error: 시청 목록을 불러오지 못했습니다. 잠시 후 다시 시도해주세요.\n\nRetry button: 다시 시도\n\n1.3 Toasts\n\nPriority updated: 우선순위가 업데이트되었습니다.\n\nPause on: 시청이 일시정지되었습니다.\n\nPause off: 시청이 재개되었습니다.\n\nDelete success: 시청이 삭제되었습니다.\n\nDelete confirm title: 시청을 삭제할까요?\n\nDelete confirm body: 삭제하면 복구할 수 없습니다.\n\nDelete confirm buttons: 삭제, 취소\n\nDuplicate video error: 이미 등록된 영상입니다.\n\nInvalid YouTube URL: 유효한 유튜브 영상 링크가 아닙니다.\n\nStatus fetch error: 시청 현황을 불러오지 못했습니다.\n\n1.4 Status labels\n\nMap backend status to Korean:\n\nQUEUED -> 대기열\n\nRUNNING -> 진행중\n\nPAUSED -> 일시정지\n\nCOMPLETED -> 완료\n\nFAILED -> 오류\n\n2) 시청관리 테이블: Column Spec (Must Implement)\n\nImplement a table (responsive) with these columns in this order:\n\n시청 고유번호\n\nvalue: watchId\n\nfallback: — if not started yet (but should be created at start/registration per requirement)\n\n상태\n\npill/badge with the Korean label above\n\ncolor scheme: neutral for queued, green for running, amber for paused, gray for completed, red for error\n\n영상\n\ntitle (primary line, truncatable)\n\nsubline: videoId (monospace, copy button optional)\n\n채널\n\nshow @handle if available; otherwise plain handle\n\ntooltip: “핸들네임”\n\n등록방법\n\nMANUAL -> 직접 등록\n\nAPI -> API 등록\n\n현재 시청중 (summary, NOT a huge list)\n\nshow: 디바이스 {viewingDeviceCount}대 / 노드 {nodeCount}개\n\nIf list API doesn’t include these counts, show — and provide “시청 현황” action to fetch on demand.\n\n우선순위\n\nswitch toggle priorityEnabled\n\nlabel for SR: 우선순위\n\n시작/생성일\n\nshow startedAt if exists else createdAt\n\nformatted YYYY.MM.DD HH:mm\n\n액션\n\nbuttons:\n\n시청 현황 (opens modal, fetch on demand)\n\n일시정지 / 재개 (toggle based on paused/status)\n\n삭제\n\nResponsive rules:\n\nOn narrow screens, collapse columns 6–8 into a “요약” cell or row expander.\n\nKeep “상태/시청고유번호/액션” visible.\n\nPerformance:\n\nDo not fetch status per row automatically unless API already returns summary counts.\n\nUse pagination or virtualization if list can be long.\n\n3) 시청 고유번호(Watch ID) generation rules (Strict)\n\nFormat: YYYYMMDD_<normalizedHandle>_<seq3>\n\nYYYYMMDD = Korea local date at the time of “시청 시작” OR campaign registration trigger.\n\n<normalizedHandle>:\n\nremove leading @\n\nallow [a-zA-Z0-9_-.] only; replace others with _\n\n<seq3>:\n\n3-digit, zero padded, increments per (date, handle)\n\nImplementation requirement:\n\nPrefer server to generate atomically.\n\nIf server not available, FE must request next sequence from server:\n\nPOST /watch-id/next body { date: \"YYYYMMDD\", handle: \"...\" } → { watchId }\n\nDo NOT attempt to compute seq purely client-side without a server lock.\n\nAlso:\n\n“영상이 등록될 때 이러한 컨디션에 의해 고유번호를 생성하고 시청을 시작”:\n\nOn campaign creation success, immediately start watch session OR enqueue it with generated watchId.\n\nDocument which step triggers watchId creation; implement whichever is consistent with existing flow.\n\n4) Replace Logs with “시청 현황” query modal\n\nRemove any “로그/로깅” UI and routes. Instead:\n\nAdd action button 시청 현황\n\nOn click:\n\nopen modal with loading skeleton\n\nfetch GET /watch-sessions/:id/status\n\ndisplay:\n\n노드 수: {nodeCount}\n\n시청중 디바이스: {viewingDeviceCount}대\n\noptional breakdown table if returned\n\nModal copy:\n\ntitle: 현재 시청 현황\n\nclose: 닫기\n\n5) Fix actions: Priority / Pause / Delete (must work)\n\nWire buttons to API:\n\nPriority:\n\nPATCH /watch-sessions/:id/priority { enabled }\n\nPause/Resume:\n\nPATCH /watch-sessions/:id/pause { paused }\n\nDelete:\n\nDELETE /watch-sessions/:id\n\nUI behavior:\n\nEach action shows inline loading\n\nDisable conflicting actions while request pending\n\nOn success show toast (copy above)\n\nOn failure show toast with generic error: 요청을 처리하지 못했습니다. 다시 시도해주세요.\n\n6) Prevent duplicate video registration by videoId\n\nOn video registration page:\n\nNormalize input URL → extract videoId\n\nBefore submit:\n\ncall GET /videos/exists?videoId=... (or GET /campaigns?videoId=...)\n\nif exists: block submit and show toast 이미 등록된 영상입니다.\n\nAlso handle server 409 conflict gracefully with same message.\n\n7) YouTube URL canonicalization\n\nImplement utility:\nnormalizeYouTubeUrl(input: string): { videoId: string; canonicalUrl: string }\n\nRules:\n\nAccept input forms:\n\nhttps://www.youtube.com/watch?v=<id>&...\n\nhttps://youtu.be/<id>?...\n\nhttps://www.youtube.com/shorts/<id>?...\n\nhttps://www.youtube.com/embed/<id>?...\n\nOutput must always be:\n\ncanonicalUrl = \"https://www.youtube.com/watch?v=\" + videoId\n\nDiscard all query parameters and non-canonical domains in stored/displayed url.\n\nAdd tests (if repo has test setup):\n\nProvide unit tests for normalize/extract across formats.\n\n8) Implementation deliverables\nMust include\n\nA clear “changed files” list\n\nCode implementing:\n\ntable column changes\n\nmodal for status\n\nactions wiring\n\nyoutube url normalization\n\nduplicate check\n\ntheme button fix\n\nstring replacements “작업→시청”\n\nSuggested file structure (adapt)\n\nsrc/pages/watch/index.tsx or app/watch/page.tsx\n\nsrc/features/watch/api.ts\n\nsrc/features/watch/types.ts\n\nsrc/features/watch/hooks.ts\n\nsrc/components/watch/WatchTable.tsx\n\nsrc/components/watch/WatchStatusModal.tsx\n\nsrc/lib/youtube/normalizeYouTubeUrl.ts\n\nsrc/pages/videos/new.tsx or app/videos/new/page.tsx\n\nAcceptance checklist (must verify)\n\n UI has no “작업” wording; uses “시청관리/새 시청” etc.\n\n “새 시청” button matches theme primary and has focus ring\n\n Table shows specified columns and responsive behavior\n\n “시청 현황” modal replaces logs and fetches counts correctly\n\n Priority / pause / delete all function and show correct toasts\n\n Duplicate video registration is blocked by videoId\n\n Any YouTube link input is stored/displayed as canonical watch URL only\n\n No per-row heavy status fetching by default (performance)"
    }
  },
  "todo_summary": {
    "pending": 0,
    "in_progress": 0,
    "completed": 0
  },
  "wisdom_exported": false,
  "background_jobs": {
    "active": [],
    "recent": [],
    "stats": null
  }
}